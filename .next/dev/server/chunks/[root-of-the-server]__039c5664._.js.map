{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghulam/projects/ifgcrm/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient } from \"@supabase/ssr\"\nimport { cookies } from \"next/headers\"\n\nexport async function createClient() {\n  const cookieStore = await cookies()\n\n  const supabaseUrl =\n    process.env.NEXT_PUBLIC_SUPABASE_URL || process.env.SUPABASE_URL || \"https://cujprjusexjzuapydiuf.supabase.co\"\n\n  const supabaseKey =\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY ||\n    process.env.SUPABASE_ANON_KEY ||\n    \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImN1anByanVzZXhqenVhcHlkaXVmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI2MDg1MTQsImV4cCI6MjA3ODE4NDUxNH0.TTRG0g8vh3-IpQ3YkJxFoLlQEa5IfAAkJIUrJa1XogA\"\n\n  return createServerClient(supabaseUrl, supabaseKey, {\n    cookies: {\n      getAll() {\n        return cookieStore.getAll()\n      },\n      setAll(cookiesToSet) {\n        try {\n          cookiesToSet.forEach(({ name, value, options }) => cookieStore.set(name, value, options))\n        } catch {\n          // The \"setAll\" method was called from a Server Component.\n          // This can be ignored if you have middleware refreshing\n          // user sessions.\n        }\n      },\n    },\n  })\n}\n\nexport { createClient as createServerClient }\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AACA;;;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IAEjC,MAAM,cACJ,QAAQ,GAAG,CAAC,wBAAwB,IAAI,QAAQ,GAAG,CAAC,YAAY,IAAI;IAEtE,MAAM,cACJ,wPACA,QAAQ,GAAG,CAAC,iBAAiB,IAC7B;IAEF,OAAO,IAAA,iMAAkB,EAAC,aAAa,aAAa;QAClD,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAAK,YAAY,GAAG,CAAC,MAAM,OAAO;gBAClF,EAAE,OAAM;gBACN,0DAA0D;gBAC1D,wDAAwD;gBACxD,iBAAiB;gBACnB;YACF;QACF;IACF;AACF","debugId":null}},
    {"offset": {"line": 83, "column": 0}, "map": {"version":3,"sources":["file:///Users/ghulam/projects/ifgcrm/app/api/lists/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\nimport { createClient } from \"@/lib/supabase/server\"\n\nexport async function GET() {\n  try {\n    const supabase = await createClient()\n\n    const { data: lists, error } = await supabase\n      .from(\"lists\")\n      .select(\"*\")\n      .order(\"created_at\", { ascending: false })\n\n    if (error) {\n      console.error(\"[v0] Error fetching lists:\", error)\n      throw error\n    }\n\n    const listsWithCounts = await Promise.all(\n      (lists || []).map(async (list: any) => {\n        const { count, error: countError } = await supabase\n          .from(\"list_memberships\")\n          .select(\"*\", { count: \"exact\", head: true })\n          .eq(\"list_id\", list.id)\n\n        if (countError) {\n          console.error(`[v0] Error counting members for list ${list.id}:`, countError)\n        }\n\n        return {\n          id: list.id,\n          name: list.name,\n          description: list.description || null,\n          type: list.type as \"STATIC\" | \"SMART\",\n          contactCount: count || 0,\n          createdAt: list.created_at,\n        }\n      })\n    )\n\n    return NextResponse.json(listsWithCounts)\n  } catch (error) {\n    console.error(\"[v0] Error fetching lists:\", error)\n    return NextResponse.json([])\n  }\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const supabase = await createClient()\n    const body = await request.json()\n\n    const { name, description, type, filtersJson } = body\n\n    if (!name || typeof name !== \"string\" || name.trim() === \"\") {\n      return NextResponse.json(\n        { error: \"Name is required\" },\n        { status: 400 }\n      )\n    }\n\n    const listType = type || \"STATIC\"\n\n    if (![\"STATIC\", \"SMART\"].includes(listType)) {\n      return NextResponse.json(\n        { error: \"Type must be STATIC or SMART\" },\n        { status: 400 }\n      )\n    }\n\n    const insertData: any = {\n      name: name.trim(),\n      description: description || null,\n      type: listType,\n    }\n\n    if (listType === \"SMART\" && filtersJson) {\n      insertData.filters_json = typeof filtersJson === \"string\" \n        ? filtersJson \n        : JSON.stringify(filtersJson)\n    }\n\n    const { data, error } = await supabase\n      .from(\"lists\")\n      .insert([insertData])\n      .select()\n      .single()\n\n    if (error) {\n      console.error(\"[v0] Error creating list:\", error)\n      throw error\n    }\n\n    return NextResponse.json({\n      id: data.id,\n      name: data.name,\n      description: data.description || null,\n      type: data.type as \"STATIC\" | \"SMART\",\n      contactCount: 0,\n      createdAt: data.created_at,\n    })\n  } catch (error) {\n    console.error(\"[v0] Error creating list:\", error)\n    return NextResponse.json(\n      { error: \"Failed to create list\" },\n      { status: 500 }\n    )\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,WAAW,MAAM,IAAA,2IAAY;QAEnC,MAAM,EAAE,MAAM,KAAK,EAAE,KAAK,EAAE,GAAG,MAAM,SAClC,IAAI,CAAC,SACL,MAAM,CAAC,KACP,KAAK,CAAC,cAAc;YAAE,WAAW;QAAM;QAE1C,IAAI,OAAO;YACT,QAAQ,KAAK,CAAC,8BAA8B;YAC5C,MAAM;QACR;QAEA,MAAM,kBAAkB,MAAM,QAAQ,GAAG,CACvC,CAAC,SAAS,EAAE,EAAE,GAAG,CAAC,OAAO;YACvB,MAAM,EAAE,KAAK,EAAE,OAAO,UAAU,EAAE,GAAG,MAAM,SACxC,IAAI,CAAC,oBACL,MAAM,CAAC,KAAK;gBAAE,OAAO;gBAAS,MAAM;YAAK,GACzC,EAAE,CAAC,WAAW,KAAK,EAAE;YAExB,IAAI,YAAY;gBACd,QAAQ,KAAK,CAAC,CAAC,qCAAqC,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,EAAE;YACpE;YAEA,OAAO;gBACL,IAAI,KAAK,EAAE;gBACX,MAAM,KAAK,IAAI;gBACf,aAAa,KAAK,WAAW,IAAI;gBACjC,MAAM,KAAK,IAAI;gBACf,cAAc,SAAS;gBACvB,WAAW,KAAK,UAAU;YAC5B;QACF;QAGF,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,OAAO,gJAAY,CAAC,IAAI,CAAC,EAAE;IAC7B;AACF;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,WAAW,MAAM,IAAA,2IAAY;QACnC,MAAM,OAAO,MAAM,QAAQ,IAAI;QAE/B,MAAM,EAAE,IAAI,EAAE,WAAW,EAAE,IAAI,EAAE,WAAW,EAAE,GAAG;QAEjD,IAAI,CAAC,QAAQ,OAAO,SAAS,YAAY,KAAK,IAAI,OAAO,IAAI;YAC3D,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAmB,GAC5B;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,WAAW,QAAQ;QAEzB,IAAI,CAAC;YAAC;YAAU;SAAQ,CAAC,QAAQ,CAAC,WAAW;YAC3C,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA+B,GACxC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,aAAkB;YACtB,MAAM,KAAK,IAAI;YACf,aAAa,eAAe;YAC5B,MAAM;QACR;QAEA,IAAI,aAAa,WAAW,aAAa;YACvC,WAAW,YAAY,GAAG,OAAO,gBAAgB,WAC7C,cACA,KAAK,SAAS,CAAC;QACrB;QAEA,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,SACL,MAAM,CAAC;YAAC;SAAW,EACnB,MAAM,GACN,MAAM;QAET,IAAI,OAAO;YACT,QAAQ,KAAK,CAAC,6BAA6B;YAC3C,MAAM;QACR;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,IAAI,KAAK,EAAE;YACX,MAAM,KAAK,IAAI;YACf,aAAa,KAAK,WAAW,IAAI;YACjC,MAAM,KAAK,IAAI;YACf,cAAc;YACd,WAAW,KAAK,UAAU;QAC5B;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}